(window.pwWpJsonP=window.pwWpJsonP||[]).push([[2],{304:function(t,e,s){var a=s(352);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,s(12).default)("6ccdf3b9",a,!1,{})},305:function(t,e,s){var a=s(354);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,s(12).default)("01ea47b0",a,!1,{})},306:function(t,e,s){var a=s(356);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,s(12).default)("080ed1db",a,!1,{})},307:function(t,e,s){var a=s(358);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,s(12).default)("087fe63c",a,!1,{})},351:function(t,e,s){"use strict";var a=s(304);s.n(a).a},352:function(t,e,s){},353:function(t,e,s){"use strict";var a=s(305);s.n(a).a},354:function(t,e,s){},355:function(t,e,s){"use strict";var a=s(306);s.n(a).a},356:function(t,e,s){},357:function(t,e,s){"use strict";var a=s(307);s.n(a).a},358:function(t,e,s){},419:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app-content"}},[s("div",{staticClass:"app-content-left"},[s("breadcrumb",{attrs:{showAddNew:!1,items:t.breadcrumb}}),t._v(" "),s("div",{staticClass:"item-list"},[t._l(t.options,(function(e,a){return void 0===t.$route.params.action?s("generic-line",{key:a,attrs:{label:e[0],icon:e[1],params:{action:a}}}):t._e()})),t._v(" "),"export"===t.$route.params.action?s("export"):t._e(),t._v(" "),"import"===t.$route.params.action?s("import"):t._e()],2)],1)])};a._withStripped=!0;var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"backup-dialog export-container"},[s("div",{staticClass:"step-1"},[s("translate",{attrs:{tag:"h1",say:"Choose Format"}}),t._v(" "),s("div",{staticClass:"step-content"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.format,expression:"format"}],attrs:{id:"passwords-export-target",disabled:t.exporting},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.format=e.target.multiple?s:s[0]}}},[s("translate",{attrs:{tag:"option",value:"json",say:"Database Backup"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"csv",say:"Predefined CSV"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"xlsx",say:"Microsoft Excel"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"ods",say:"Open Office Calc"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"customCsv",say:"Custom CSV"}})],1)])],1),t._v(" "),t.step>1?s("div",{staticClass:"step-2"},[s("translate",{attrs:{tag:"h1",say:"Select Options"}}),t._v(" "),"json"===t.format&&t.allowEnc?s("div",{staticClass:"step-content"},[s("translate",{attrs:{tag:"label",for:"passwords-export-encrypt",say:"Backup password",title:"(Optional) Encrypts the backup"}}),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.options.password,expression:"options.password"}],attrs:{type:"password",id:"passwords-export-encrypt",minlength:"10",title:t.backupPasswordTitle,disabled:t.exporting,autocomplete:"new-password",readonly:""},domProps:{value:t.options.password},on:{input:function(e){e.target.composing||t.$set(t.options,"password",e.target.value)}}}),t._v(" "),s("br"),t._v(" "),s("br")],1):t._e(),t._v(" "),"customCsv"!==t.format?s("div",{staticClass:"step-content"},["xlsx"===t.format||"ods"===t.format?s("translate",{staticClass:"office warning",attrs:{tag:"div",say:"The import only supports CSV"}}):t._e(),t._v(" "),s("div",{staticClass:"step-section"},[s("input",{attrs:{type:"checkbox",id:"passwords-export-passwords",value:"passwords",disabled:t.exporting},domProps:{checked:-1!==t.models.indexOf("passwords")},on:{change:function(e){return t.setExportModel(e)}}}),t._v(" "),s("translate",{attrs:{tag:"label",for:"passwords-export-passwords",say:"Export Passwords"}})],1),t._v(" "),s("div",{staticClass:"step-section"},[s("input",{attrs:{type:"checkbox",id:"passwords-export-folders",value:"folders",disabled:t.exporting},domProps:{checked:-1!==t.models.indexOf("folders")},on:{change:function(e){return t.setExportModel(e)}}}),t._v(" "),s("translate",{attrs:{tag:"label",for:"passwords-export-folders",say:"Export Folders"}})],1),t._v(" "),s("div",{staticClass:"step-section"},[s("input",{attrs:{type:"checkbox",id:"passwords-export-tags",value:"tags",disabled:t.exporting},domProps:{checked:-1!==t.models.indexOf("tags")},on:{change:function(e){return t.setExportModel(e)}}}),t._v(" "),s("translate",{attrs:{tag:"label",for:"passwords-export-tags",say:"Export Tags"}})],1),t._v(" "),s("br"),t._v(" "),s("div",{staticClass:"step-section"},[-1!==t.models.indexOf("passwords")?s("input",{directives:[{name:"model",rawName:"v-model",value:t.options.excludeShared,expression:"options.excludeShared"}],attrs:{type:"checkbox",id:"passwords-export-shared",disabled:t.exporting},domProps:{checked:Array.isArray(t.options.excludeShared)?t._i(t.options.excludeShared,null)>-1:t.options.excludeShared},on:{change:function(e){var s=t.options.excludeShared,a=e.target,r=!!a.checked;if(Array.isArray(s)){var o=t._i(s,null);a.checked?o<0&&t.$set(t.options,"excludeShared",s.concat([null])):o>-1&&t.$set(t.options,"excludeShared",s.slice(0,o).concat(s.slice(o+1)))}else t.$set(t.options,"excludeShared",r)}}}):t._e(),t._v(" "),-1!==t.models.indexOf("passwords")?s("translate",{attrs:{tag:"label",for:"passwords-export-shared",say:"Export passwords shared with me"}}):t._e()],1)],1):s("div",{staticClass:"step-content"},[s("translate",{attrs:{tag:"label",for:"passwords-export-csv-db",say:"Database"}}),t._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.options.db,expression:"options.db"}],attrs:{id:"passwords-export-csv-db",disabled:t.exporting},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.options,"db",e.target.multiple?s:s[0])}}},[s("translate",{attrs:{tag:"option",value:"passwords",say:"Passwords"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"folders",say:"Folders"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"tags",say:"Tags"}})],1),t._v(" "),s("br"),t._v(" "),s("translate",{attrs:{tag:"label",for:"passwords-export-csv-delimiter",say:"Field delimiter"}}),t._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.options.delimiter,expression:"options.delimiter"}],attrs:{id:"passwords-export-csv-delimiter",disabled:t.exporting},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.options,"delimiter",e.target.multiple?s:s[0])}}},[s("translate",{attrs:{tag:"option",value:",",say:"Comma"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:";",say:"Semicolon"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:" ",say:"Space"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"\t",say:"Tab"}})],1),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("div",{staticClass:"step-section"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.options.header,expression:"options.header"}],attrs:{type:"checkbox",id:"passwords-export-csv-header",disabled:t.exporting},domProps:{checked:Array.isArray(t.options.header)?t._i(t.options.header,null)>-1:t.options.header},on:{change:function(e){var s=t.options.header,a=e.target,r=!!a.checked;if(Array.isArray(s)){var o=t._i(s,null);a.checked?o<0&&t.$set(t.options,"header",s.concat([null])):o>-1&&t.$set(t.options,"header",s.slice(0,o).concat(s.slice(o+1)))}else t.$set(t.options,"header",r)}}}),t._v(" "),s("translate",{attrs:{tag:"label",for:"passwords-export-csv-header",say:"Add Header Line"}})],1),t._v(" "),s("div",{staticClass:"step-section"},["passwords"===t.options.db?s("input",{directives:[{name:"model",rawName:"v-model",value:t.options.excludeShared,expression:"options.excludeShared"}],attrs:{type:"checkbox",id:"passwords-export-csv-shared",disabled:t.exporting},domProps:{checked:Array.isArray(t.options.excludeShared)?t._i(t.options.excludeShared,null)>-1:t.options.excludeShared},on:{change:function(e){var s=t.options.excludeShared,a=e.target,r=!!a.checked;if(Array.isArray(s)){var o=t._i(s,null);a.checked?o<0&&t.$set(t.options,"excludeShared",s.concat([null])):o>-1&&t.$set(t.options,"excludeShared",s.slice(0,o).concat(s.slice(o+1)))}else t.$set(t.options,"excludeShared",r)}}}):t._e(),t._v(" "),"passwords"===t.options.db?s("translate",{attrs:{tag:"label",for:"passwords-export-csv-shared",say:"Export passwords shared with me"}}):t._e()],1),t._v(" "),s("br"),t._v(" "),s("translate",{attrs:{tag:"h3",say:"CSV Field Mapping"}}),t._v(" "),s("div",{staticClass:"csv-mapping"},t._l(t.csvMappedFieldsSize,(function(e){return s("div",{key:e,staticClass:"csv-mapping-field"},[s("select",{attrs:{id:"passwords-mapping-"+e,disabled:t.exporting},on:{change:function(s){return t.csvFieldMapping(s,e)}}},[e===t.csvMappedFieldsSize?s("translate",{attrs:{tag:"option",say:"Please choose"}}):t._e(),t._v(" "),t._l(t.csvFieldOptions,(function(t){return s("translate",{key:t,attrs:{tag:"option",value:t,say:t.capitalize()}})}))],2)])})),0)],1)],1):t._e(),t._v(" "),t.step>2?s("div",{staticClass:"step-3"},[s("translate",{attrs:{tag:"h1",say:"Run Export"}}),t._v(" "),s("div",{staticClass:"step-content"},[s("translate",{attrs:{tag:"button",say:t.buttonText,variables:{format:this.format.toUpperCase()},disabled:t.exporting,id:"passwords-export-execute"},on:{click:t.exportDb}})],1)],1):t._e()])};r._withStripped=!0;var o=s(7),i=s(6),n=s(2),l=s(1),p=s(46),d={components:{Translate:o.a},data(){return p.a.check("backup-encryption").then(t=>{this.allowEnc=t}),{format:"json",options:{includeShared:!1},models:["passwords","folders","tags"],step:3,data:null,buttonText:"Export",exporting:!1,fieldMap:{passwords:["password","username","label","notes","url","folderLabel","tagLabels","edited","created","favorite","customFields","id","revision","folderId","tagIds","empty"],folders:["label","parentLabel","edited","created","favorite","id","revision","parentId","empty"],tags:["label","color","edited","created","favorite","id","revision","empty"]},allowEnc:!1}},computed:{csvFieldOptions(){return this.fieldMap[this.options.db]},backupPasswordTitle:()=>l.a.translate("(Optional) Encrypts the backup"),csvMappedFieldsSize(){return this.options.mapping.length+1}},created(){this.allowEnc&&this.preventPasswordFill(1e3)},methods:{preventPasswordFill(t=300){setTimeout(()=>{document.getElementById("passwords-export-encrypt").removeAttribute("readonly")},t)},async exportDb(){if(this.data)this.downloadFile();else{this.buttonText="Waiting...",this.exporting=!0;try{(new((await Promise.all([s.e(17),s.e(6)]).then(s.bind(null,416))).ExportManager)).exportDatabase(this.format,this.models,this.options).catch(t=>{this.exporting=!1,console.error(t),n.a.alert(t.message,"Export error")}).then(t=>{t?(this.data=t,this.buttonText="Download {format}"):this.exporting&&n.a.alert("There is no data to export","Nothing to export"),this.exporting=!1})}catch(t){console.error(t),n.a.alert(["Unable to load {module}",{module:"ExportManager"}],"Network error")}}},setExportModel(t){let e=t.target.value,s=this.models.indexOf(e);t.target.checked?"csv"===this.format&&-1!==navigator.userAgent.indexOf("WebKit")?this.models=[e]:-1===s&&this.models.push(e):-1!==s&&this.models.remove(s)},generateFilename(t){let e=new Date,s=[],a="customCsv"===this.format?"csv":this.format;t.length>1&&"csv"===a&&(a="zip");for(let e=0;e<t.length;e++)s.push(l.a.translate(t[e].capitalize()));return`${s.join("+")}_${e.toLocaleDateString()}.${a}`},downloadFile(){let t="text/csv";"csv"===this.format&&this.models.length>1&&(t="application/zip"),"ods"===this.format&&(t="application/vnd.oasis.opendocument.spreadsheet"),"xlsx"===this.format&&(t="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");let e=this.generateFilename(this.models);i.a.createDownload(this.data,e,t)},csvFieldMapping(t,e){let s=this.options.mapping.clone();s[e-1]=t.target.value;for(let t=s.length-1;t>0&&("null"===s[t]&&("null"===s[t-1]||t===s.length-1));t--)s.pop();this.options.mapping=s},validateStep(){0===this.models.length||"json"===this.format&&this.options.password&&this.options.password.length<10||"customCsv"===this.format&&0===this.options.mapping.length?this.step=2:this.step=3,this.buttonText="Export",this.data=null}},watch:{format(t){"customCsv"===t?this.options={db:"passwords",delimiter:",",header:!0,mapping:[]}:"csv"===t&&-1!==navigator.userAgent.indexOf("WebKit")&&this.models.length>1?this.models=[this.models.shift()]:"json"===t&&this.allowEnc&&this.preventPasswordFill(),this.validateStep()},models(){this.validateStep()},"options.db"(t){this.models=[t],this.options.mapping=[],document.querySelectorAll(".csv-mapping-field select").forEach(t=>{t.value=null}),this.validateStep()},"options.password"(t){0!==t.length&&t.length<10?document.getElementById("passwords-export-encrypt").className="invalid":document.getElementById("passwords-export-encrypt").className=""},options:{handler(){this.validateStep()},deep:!0}}},c=(s(351),s(4)),v=Object(c.a)(d,r,[],!1,null,null,null);v.options.__file="src/vue/Components/Export.vue";var u=v.exports,m=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"backup-dialog import-container"},[s("div",{staticClass:"step-1"},[s("translate",{attrs:{tag:"h1",say:"Choose Format"}}),t._v(" "),s("div",{staticClass:"step-content"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.source,expression:"source"}],attrs:{id:"passwords-import-source",disabled:t.importing},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.source=e.target.multiple?s:s[0]}}},[t.source?t._e():s("translate",{attrs:{tag:"option",value:"",say:"Choose import format"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"json",say:"Database Backup"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"pwdCsv",say:"Passwords CSV"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"fldCsv",say:"Folder CSV"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"tagCsv",say:"Tags CSV"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"legacy",say:"ownCloud Passwords"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"pmanJson",say:"Passman JSON"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"pmanCsv",say:"Passman CSV"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"enpass",say:"Enpass JSON"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"bitwarden",say:"Bitwarden JSON"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"bitwardenCsv",say:"Bitwarden CSV"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"keepass",say:"KeePass CSV"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"lastpass",say:"LastPass CSV"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"dashlane",say:"Dashlane CSV"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"roboform",say:"RoboForm CSV"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"safeincloud",say:"SafeInCloud CSV"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"chrome",say:"Chrome / Google Passwords CSV"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"csv",say:"Other / Custom CSV"}})],1),t._v(" "),s("custom-csv-help",{attrs:{current:t.source},on:{trigger:function(e){t.source="csv"}}})],1)],1),t._v(" "),t.step>1?s("div",{staticClass:"step-2"},[s("translate",{attrs:{tag:"h1",say:"Select File"}}),t._v(" "),s("div",{staticClass:"step-content"},[0!==t.fileMime.length&&t.fileMime!==t.mime?s("translate",{staticClass:"file warning",attrs:{tag:"div",variables:{expected:t.mime,actual:t.fileMime},say:'The file has the type "{actual}" but "{expected}" is expected. You might have chosen the wrong file or importer.'}}):t._e(),t._v(" "),t.csv.badQuotes&&"csv"!==t.source?s("translate",{staticClass:"file warning",attrs:{tag:"div",variables:{service:t.source.capitalize()},say:"{service} is known to to generate faulty export files. Consult the manual for help if the file can not be parsed."}}):t._e(),t._v(" "),"csv"===t.source?s("div",[s("translate",{attrs:{tag:"h3",say:"CSV Options"}}),t._v(" "),s("translate",{attrs:{tag:"label",for:"passwords-import-csv-line",say:"Line Break"}}),t._v(" "),s("select",{attrs:{id:"passwords-import-csv-line",disabled:t.importing},on:{change:function(e){return t.setNewLine(e)}}},[s("translate",{attrs:{tag:"option",value:"auto",say:"Detect"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"rn",say:"Windows (CRLF, \\r\\n)"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"n",say:"Linux (LF, \\n)"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"r",say:"Mac (CR, \\r)"}})],1),t._v(" "),s("br"),t._v(" "),s("translate",{attrs:{tag:"label",for:"passwords-import-csv-delimiter",say:"Field Delimiter"}}),t._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.csv.delimiter,expression:"csv.delimiter"}],attrs:{id:"passwords-import-csv-delimiter",disabled:t.importing},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.csv,"delimiter",e.target.multiple?s:s[0])}}},[s("translate",{attrs:{tag:"option",value:"auto",say:"Detect"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:",",say:"Comma"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:";",say:"Semicolon"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:" ",say:"Space"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"\t",say:"Tab"}})],1),t._v(" "),s("br"),t._v(" "),s("translate",{attrs:{tag:"label",for:"passwords-import-csv-quote",say:"Quote Character"}}),t._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.csv.quotes,expression:"csv.quotes"}],attrs:{id:"passwords-import-csv-quote",disabled:t.importing},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.csv,"quotes",e.target.multiple?s:s[0])}}},[s("translate",{attrs:{tag:"option",value:'"',say:"Quote"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"'",say:"Single Quote"}})],1),t._v(" "),s("br"),t._v(" "),s("translate",{attrs:{tag:"label",for:"passwords-import-csv-escape",say:"Escape Character"}}),t._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.csv.escape,expression:"csv.escape"}],attrs:{id:"passwords-import-csv-escape",disabled:t.importing},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.csv,"escape",e.target.multiple?s:s[0])}}},[s("translate",{attrs:{tag:"option",value:'"',say:"Quote"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"'",say:"Single Quote"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"\\",say:"Backslash"}})],1),t._v(" "),s("br"),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.csv.badQuotes,expression:"csv.badQuotes"}],attrs:{type:"checkbox",id:"passwords-import-csv-badQuotes",disabled:t.importing},domProps:{checked:Array.isArray(t.csv.badQuotes)?t._i(t.csv.badQuotes,null)>-1:t.csv.badQuotes},on:{change:function(e){var s=t.csv.badQuotes,a=e.target,r=!!a.checked;if(Array.isArray(s)){var o=t._i(s,null);a.checked?o<0&&t.$set(t.csv,"badQuotes",s.concat([null])):o>-1&&t.$set(t.csv,"badQuotes",s.slice(0,o).concat(s.slice(o+1)))}else t.$set(t.csv,"badQuotes",r)}}}),t._v(" "),s("translate",{attrs:{tag:"label",for:"passwords-import-csv-badQuotes",say:"Detect unescaped quotes"}}),t._v(" "),s("br"),s("br")],1):t._e(),t._v(" "),s("input",{attrs:{type:"file",accept:t.mime,id:"passwords-import-file",disabled:t.importing},on:{change:function(e){return t.processFile(e)}}})],1)],1):t._e(),t._v(" "),t.step>2?s("div",{staticClass:"step-3"},[s("translate",{attrs:{tag:"h1",say:"Select Options"}}),t._v(" "),s("div",{staticClass:"step-content"},[s("div",[s("translate",{attrs:{tag:"label",for:"passwords-import-mode",say:"Conflict handling"}}),t._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.options.mode,expression:"options.mode"}],attrs:{id:"passwords-import-mode",disabled:t.importing},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.options,"mode",e.target.multiple?s:s[0])}}},[s("translate",{attrs:{tag:"option",value:"0",say:"Skip if same revision"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"1",say:"Skip always"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"2",say:"Overwrite existing"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"3",say:"Merge with existing"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"4",say:"Create new entry"}})],1),t._v(" "),"json"===t.source&&t.allowEnc?s("div",[s("translate",{attrs:{tag:"label",for:"passwords-import-encrypt",say:"Backup password",title:"For encrypted backups"}}),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.options.password,expression:"options.password"}],attrs:{type:"password",id:"passwords-import-encrypt",minlength:"10",title:t.backupPasswordTitle,disabled:t.importing,autocomplete:"new-password",readonly:""},domProps:{value:t.options.password},on:{input:function(e){e.target.composing||t.$set(t.options,"password",e.target.value)}}})],1):t._e(),t._v(" "),s("br"),t._v(" "),"enpass"===t.source?s("div",[s("br"),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.options.skipEmpty,expression:"options.skipEmpty"}],attrs:{type:"checkbox",id:"passwords-enpass-empty",disabled:t.importing},domProps:{checked:Array.isArray(t.options.skipEmpty)?t._i(t.options.skipEmpty,null)>-1:t.options.skipEmpty},on:{change:function(e){var s=t.options.skipEmpty,a=e.target,r=!!a.checked;if(Array.isArray(s)){var o=t._i(s,null);a.checked?o<0&&t.$set(t.options,"skipEmpty",s.concat([null])):o>-1&&t.$set(t.options,"skipEmpty",s.slice(0,o).concat(s.slice(o+1)))}else t.$set(t.options,"skipEmpty",r)}}}),t._v(" "),s("translate",{attrs:{tag:"label",for:"passwords-enpass-empty",say:"Don't import empty fields"}})],1):t._e(),t._v(" "),"csv"===t.source?s("div",[s("translate",{attrs:{tag:"h3",say:"Import Options"}}),t._v(" "),s("translate",{attrs:{tag:"label",for:"passwords-import-csv-db",say:"Database"}}),t._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.options.db,expression:"options.db"}],attrs:{id:"passwords-import-csv-db",disabled:t.importing},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.options,"db",e.target.multiple?s:s[0])}}},[s("translate",{attrs:{tag:"option",value:"passwords",say:"Passwords"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"folders",say:"Folders"}}),t._v(" "),s("translate",{attrs:{tag:"option",value:"tags",say:"Tags"}})],1),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.options.firstLine,expression:"options.firstLine"}],attrs:{type:"checkbox",id:"passwords-import-csv-skip",disabled:t.importing},domProps:{checked:Array.isArray(t.options.firstLine)?t._i(t.options.firstLine,null)>-1:t.options.firstLine},on:{change:function(e){var s=t.options.firstLine,a=e.target,r=!!a.checked;if(Array.isArray(s)){var o=t._i(s,null);a.checked?o<0&&t.$set(t.options,"firstLine",s.concat([null])):o>-1&&t.$set(t.options,"firstLine",s.slice(0,o).concat(s.slice(o+1)))}else t.$set(t.options,"firstLine",r)}}}),t._v(" "),s("translate",{attrs:{tag:"label",for:"passwords-import-csv-skip",say:"Skip first line"}}),t._v(" "),s("br"),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.options.repair,expression:"options.repair"}],attrs:{type:"checkbox",id:"passwords-import-csv-repair",disabled:t.importing},domProps:{checked:Array.isArray(t.options.repair)?t._i(t.options.repair,null)>-1:t.options.repair},on:{change:function(e){var s=t.options.repair,a=e.target,r=!!a.checked;if(Array.isArray(s)){var o=t._i(s,null);a.checked?o<0&&t.$set(t.options,"repair",s.concat([null])):o>-1&&t.$set(t.options,"repair",s.slice(0,o).concat(s.slice(o+1)))}else t.$set(t.options,"repair",r)}}}),t._v(" "),s("translate",{attrs:{tag:"label",for:"passwords-import-csv-repair",say:"Interpolate missing fields"}}),t._v(" "),s("br"),t._v(" "),"4"!==t.options.mode&&"passwords"===t.options.db?s("input",{directives:[{name:"model",rawName:"v-model",value:t.options.skipShared,expression:"options.skipShared"}],attrs:{type:"checkbox",id:"passwords-import-csv-shared",disabled:t.importing},domProps:{checked:Array.isArray(t.options.skipShared)?t._i(t.options.skipShared,null)>-1:t.options.skipShared},on:{change:function(e){var s=t.options.skipShared,a=e.target,r=!!a.checked;if(Array.isArray(s)){var o=t._i(s,null);a.checked?o<0&&t.$set(t.options,"skipShared",s.concat([null])):o>-1&&t.$set(t.options,"skipShared",s.slice(0,o).concat(s.slice(o+1)))}else t.$set(t.options,"skipShared",r)}}}):t._e(),t._v(" "),"4"!==t.options.mode&&"passwords"===t.options.db?s("translate",{attrs:{tag:"label",for:"passwords-import-csv-shared",say:"Don't edit passwords shared with me"}}):t._e(),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("translate",{attrs:{tag:"h3",say:"CSV Field Mapping"}}),t._v(" "),s("translate",{attrs:{tag:"label",for:"passwords-import-csv-preview-line",say:"Preview Line"}}),t._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.previewLine,expression:"previewLine"}],attrs:{id:"passwords-import-csv-preview-line",disabled:t.importing},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.previewLine=e.target.multiple?s:s[0]}}},t._l(10,(function(t){return s("translate",{key:t,attrs:{tag:"option",value:t.toString(),say:"Line {line}",variables:{line:t}}})})),1),t._v(" "),s("div",{staticClass:"csv-mapping"},t._l(t.csvSampleData,(function(e,a){return s("div",{key:a,staticClass:"csv-mapping-field",attrs:{"data-value":e,"data-id":a}},[e?s("div",{staticClass:"value"},[t._v(t._s(e))]):s("translate",{staticClass:"value",attrs:{tag:"div",say:"(no value)"}}),t._v(" "),s("select",{attrs:{id:"passwords-mapping-"+a,disabled:t.importing},on:{change:function(e){return t.csvFieldMapping(e,a)}}},[s("translate",{attrs:{tag:"option",value:"null",say:"Ignore"}}),t._v(" "),t._l(t.csvFieldOptions(a),(function(t,e){return s("translate",{key:e,attrs:{tag:"option",value:e,say:t}})}))],2)],1)})),0)],1):s("div",["enpass"!==t.source?s("br"):t._e(),t._v(" "),"4"!==t.options.mode?s("input",{directives:[{name:"model",rawName:"v-model",value:t.options.skipShared,expression:"options.skipShared"}],attrs:{type:"checkbox",id:"passwords-import-shared",disabled:t.importing},domProps:{checked:Array.isArray(t.options.skipShared)?t._i(t.options.skipShared,null)>-1:t.options.skipShared},on:{change:function(e){var s=t.options.skipShared,a=e.target,r=!!a.checked;if(Array.isArray(s)){var o=t._i(s,null);a.checked?o<0&&t.$set(t.options,"skipShared",s.concat([null])):o>-1&&t.$set(t.options,"skipShared",s.slice(0,o).concat(s.slice(o+1)))}else t.$set(t.options,"skipShared",r)}}}):t._e(),t._v(" "),"4"!==t.options.mode?s("translate",{attrs:{tag:"label",for:"passwords-import-shared",say:"Don't edit passwords shared with me"}}):t._e()],1)],1)])],1):t._e(),t._v(" "),t.step>3?s("div",{staticClass:"step-4"},[s("translate",{attrs:{tag:"h1",say:"Run Import"}}),t._v(" "),s("div",{staticClass:"step-content"},[null===t.progress.status?s("translate",{attrs:{tag:"button",say:"Import",id:"passwords-import-execute"},on:{click:t.importDb}}):s("div",{staticClass:"import-progress"},[s("progress",{class:t.progress.style,attrs:{max:t.progress.total,title:t.progress.status},domProps:{value:t.progress.processed}}),t._v(" "),s("translate",{attrs:{say:t.progress.status}})],1)],1)],1):t._e()])};m._withStripped=!0;var h=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"import-guide-container"},[t.hasGuide?s("translate",{staticClass:"link",attrs:{tag:"a",href:t.guideLink,target:"_blank",say:"Read the {label} import guide",variables:t.guideVars}}):t._e(),t._v(" "),t.hasGuide&&t.csvVisible?s("translate",{attrs:{say:"or"}}):t._e(),t._v(" "),t.csvVisible?s("translate",{staticClass:"csv-guide",attrs:{tag:"button",say:t.csvLabel},on:{click:t.openCsvHelp}}):t._e()],1)};h._withStripped=!0;var g={components:{Translate:o.a},props:["current"],data:()=>({guides:{pmanCsv:{label:"Passman",link:"#/help/Import%2FImport-from-Passman"},pmanJson:{label:"Passman",link:"#/help/Import%2FImport-from-Passman"},enpass:{label:"Enpass",link:"#/help/Import%2FImport-from-Enpass"},json:{label:l.a.translate("database backup"),link:"#/help/Import%2FImport-from-backup"},chrome:{label:"Chrome",link:"#/help/Import%2FImport-from-Chrome"},csv:{label:l.a.translate("custom CSV"),link:"#/help/Import%2FImport-from-custom-CSV"}}}),computed:{csvVisible(){return"csv"!==this.current},csvLabel(){return this.hasGuide?"try the generic CSV import":"No import for your CSV?"},guideVars(){return{label:this.guides[this.current].label}},guideLink(){return this.guides[this.current].link},hasGuide(){return this.guides.hasOwnProperty(this.current)}},methods:{openCsvHelp(){i.a.openLink(this.guides.csv.link),this.csvVisible||this.$emit("trigger")}}},f=(s(353),Object(c.a)(g,h,[],!1,null,null,null));f.options.__file="src/vue/Import/CustomCsvHelp.vue";var y={components:{CustomCsvHelp:f.exports,Translate:o.a},data(){return p.a.check("backup-encryption").then(t=>{this.allowEnc=t}),{source:"",type:"json",mime:"application/json",fieldMap:{passwords:["password","username","label","notes","url","edited","favorite","folderLabel","tagLabels","customFields","folderId","tagIds","id","revision"],folders:["label","edited","favorite","parentLabel","parentId","id","revision"],tags:["label","color","edited","favorite","id","revision"]},file:null,fileMime:"",csvFile:null,csvReady:!1,csv:{newLine:"auto",delimiter:"auto",quotes:'"',escape:'"',badQuotes:!1},options:{mode:0,skipShared:!0,skipEmpty:!1},step:1,previewLine:1,importing:!1,progress:{style:"",processed:0,total:0,status:null},allowEnc:!1}},computed:{csvSampleData(){let t=this.file;return t.length>=this.previewLine?t[this.previewLine-1]:t[t.length-1]},backupPasswordTitle:()=>l.a.translate("For encrypted backups")},methods:{preventPasswordFill(t=300){this.allowEnc&&setTimeout(()=>{document.getElementById("passwords-import-encrypt").removeAttribute("readonly")},t)},async importDb(){this.progress.style="",this.importing=!0;try{(new((await s.e(9).then(s.bind(null,423))).ImportManager)).importDatabase(this.file,this.type,this.options,this.registerProgress).catch(t=>{console.error(t),this.importing=!1,this.progress.style="error",this.progress.status="Import failed",n.a.alert(t.message,"Import error")}).then((t=[])=>{if(this.importing=!1,"error"===this.progress.style||t.length){if(t.length){this.progress.style="warn",this.progress.status="Import partially failed";let e=l.a.translate("Some objects had errors:")+" "+t.join(" ")+" "+l.a.translate("More information can be found in the log. (Press F12)");n.a.alert(e,"Import error")}}else this.progress.style="success",this.progress.status="Import successful"})}catch(t){n.a.alert(["Unable to load {module}",{module:"ImportManager"}],"Network error")}},processFile(t){let e=t.target.files[0];if(this.fileMime=e.type,"text/csv"===this.mime)this.readCsv(e);else{let t=new FileReader;t.onload=t=>{this.file=t.target.result},t.readAsText(e)}},async readCsv(t){let e;this.csvReady=!1,this.csvFile=t,this.file=t;try{e=await s.e(5).then(s.t.bind(null,417,7))}catch(t){console.error(t),n.a.alert(["Unable to load {module}",{module:"CsvHero"}],"Network error")}try{let s=await e.default.parse(t,{newLine:this.csv.newLine,delimiter:this.csv.delimiter,quotes:this.csv.quotes,escape:this.csv.escape,strictSpaces:!1,strictRows:!1,strictQuotes:!this.csv.badQuotes,skipEmptyRows:!0,skipEmptyFieldRows:!0,trimFields:!0});this.csvParseComplete(s)}catch(t){this.csvParseComplete(t)}},csvParseComplete(t){if(0===t.errors.length)this.file=t.data,this.csvReady=!0;else{document.getElementById("passwords-import-file").value=null,this.csvFile=null,this.file=null;let e=[];for(let s=0;s<t.errors.length;s++){let a=t.errors[s],r=l.a.translate(a.message);e.push(l.a.translate("{message} in line {line} character {character}.",{message:r,line:a.line,character:a.character}))}console.error(t.errors),n.a.alert(["The file could not be parsed: {errors}",{errors:e.join(" ")}],"Import error")}},registerProgress(t,e,s){this.progress.processed=t,this.progress.total=e,null!==s&&(this.progress.status=s)},csvFieldOptions(t){let e=this.fieldMap[this.options.db],s={};for(let a=0;a<e.length;a++){let r=e[a],o=this.options.mapping.indexOf(r);-1!==o&&o!==t||(s[r]=r.capitalize())}return s},csvFieldMapping(t,e){let s=this.options.mapping.clone(),a=t.target.value;"null"===a&&(a=null),s[e]=a,this.options.mapping=s},setNewLine(t){let e=t.target.value,s={n:"\n",r:"\r",rn:"\r\n"};s.hasOwnProperty(e)?this.csv.newLine=s[e]:this.csv.newLine="auto"},validateStep(){this.progress.status=null,null===this.file?this.step=2:"csv"===this.source?"passwords"===this.options.db&&-1!==this.options.mapping.indexOf("password")||""+this.options.mode=="3"&&this.options.mapping.length>0&&!this.options.mapping.isNull()||-1!==this.options.mapping.indexOf("label")?this.step=this.csvReady?4:2:this.csvReady?this.step=3:this.step=2:"json"===this.source?(this.preventPasswordFill(),this.step=4):"text/csv"!==this.mime||this.csvReady?this.step=4:this.step=2}},watch:{source(t){let e=this.mime;switch(this.progress.status=null,this.csv.badQuotes=!1,this.csv.newLine="auto",this.options.mode=3,this.mime="text/csv",this.type="csv",t){case"json":this.options.mode=0,this.mime="application/json",this.type="json";break;case"pmanJson":this.mime="application/json",this.type="pmanJson";break;case"enpass":this.mime="application/json",this.options.skipEmpty=!0,this.type="enpass";break;case"bitwarden":this.mime="application/json",this.type="bitwarden";break;case"keepass":this.csv.escape="\\";case"legacy":case"roboform":case"lastpass":case"bitwardenCsv":this.options.profile=t;break;case"safeincloud":this.csv.newLine="\r\n",this.options.profile=t;break;case"pmanCsv":this.type="pmanCsv";case"dashlane":this.options.profile=t,this.csv.badQuotes=!0;break;case"pwdCsv":this.options.profile="passwords",this.options.mode=2;break;case"fldCsv":this.options.profile="folders",this.options.mode=2;break;case"tagCsv":this.options.profile="tags",this.options.mode=2;break;case"csv":this.options={mode:3,skipShared:!0,firstLine:1,delimiter:"auto",db:"passwords",mapping:[],repair:!0,profile:"custom"}}e!==this.mime&&this.file&&(document.getElementById("passwords-import-file").value=null,this.fileMime="",this.csvFile=null,this.file=null),this.validateStep()},file(){this.validateStep()},options:{handler(){this.validateStep()},deep:!0},csv:{handler(){this.csvFile&&this.readCsv(this.csvFile)},deep:!0},"options.db"(){document.querySelectorAll(".csv-mapping-field select").forEach(t=>{t.value=null}),"csv"===this.source&&(this.options.mapping=[]),this.validateStep()}}},b=(s(355),Object(c.a)(y,m,[],!1,null,null,null));b.options.__file="src/vue/Components/Import.vue";var _=b.exports,w=s(28),x=s(148),k={components:{Export:u,Import:_,Translate:o.a,Breadcrumb:w.a,GenericLine:x.a},data:()=>({breadcrumb:[],options:{export:["Backup or export","download"],import:["Restore or import","upload"]}}),created(){this.updateRoute()},methods:{updateRoute(){if(void 0!==this.$route.params.action){let t=this.options[this.$route.params.action];this.breadcrumb=[{path:{name:"Backup"},label:l.a.translate("Backup and Restore")},{path:this.$route.path,label:l.a.translate(t[0])}]}else this.breadcrumb=[{path:{name:"Backup"},label:l.a.translate("Backup and Restore")}]}},watch:{$route:function(){this.updateRoute()}}},C=(s(357),Object(c.a)(k,a,[],!1,null,null,null));C.options.__file="src/vue/Section/Backup.vue";e.default=C.exports}}]);